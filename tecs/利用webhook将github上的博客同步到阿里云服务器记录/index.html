<!doctype html>
<html lang="en-us">
  <head>
    <title>利用webhook将github上的博客同步到阿里云服务器记录 // abin の 成长之路</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.89.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="abin" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.88e7083eff65effb7485b6e6f38d10afbec25093a6fac42d734ce9024d3defbd.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="利用webhook将github上的博客同步到阿里云服务器记录"/>
<meta name="twitter:description" content="写在前面，如何用hugo搭建博客并推送到github，可以参考前文Windows上安装hugo并且推送到github过程记录
本文主要记录，从windows创建好的博文推送到github之后，如何利用webhook，从github拉取到阿里云服务器上
1、服务器上安装git工具
yum install git #安装好之后，查看是否安装成功 git --version 2、下载github-webhook工具
#到这个网站找最新的 https://github.com/yezihack/github-webhook/releases #github release如果下载太慢可以试试这个 wget http://img.sgfoot.com/github-webhook1.4.1.linux-amd64.tar.gz 3、解压安装
tar -zxvf github-webhook1.4.1.linux-amd64.tar.gz cp github-webhook /usr/bin/ chmod u&#43;x /usr/bin/github-webhook cd /usr/bin 4、启动webhook,我这里是使用后台运行的方式
nohup github-webhook -b /www/wwwroot/github-webhook-shell.sh -s yourself-secret &amp; 这里的-b后面的路径是拉取github内容的脚本; -s 后面的是密码，也是github那边的webhook设置的密码，随便设置，两边到时候保持一致就可以了
#! /bin/bash git --git-dir=&#34;/www/wwwroot/120.25.194.155-520/kevinbin123.github.io/.git&#34; --work-tree=&#34;/www/wwwroot/120.25.194.155-520/kevinbin123.github.io&#34; pull origin hugo exit 0 5、测试是否web-hook能通(ip换成自己的服务器ip)
http://ip:2020/ping ps，处理阿里云那边的防火墙要开端口，自己的服务器的防火墙端口也要开放（一下是centos8开端口的方法）
firewall-cmd --list-all firewall-cmd --add-port=2020/tcp --permanent firewall-cmd --reload firewall-cmd --list-all 6、生成公钥配置到github上
ssh-keygen -t rsa cat .ssh/id_rsa.pub 复制代码 然后复制到github的settings-&gt;SSH and GPG keys上 7、进入到自己的服务器的网站路径下，我这边是因为安装了宝塔，直接建了一个网站;把gitHub上的内容先clone下来"/>

    <meta property="og:title" content="利用webhook将github上的博客同步到阿里云服务器记录" />
<meta property="og:description" content="写在前面，如何用hugo搭建博客并推送到github，可以参考前文Windows上安装hugo并且推送到github过程记录
本文主要记录，从windows创建好的博文推送到github之后，如何利用webhook，从github拉取到阿里云服务器上
1、服务器上安装git工具
yum install git #安装好之后，查看是否安装成功 git --version 2、下载github-webhook工具
#到这个网站找最新的 https://github.com/yezihack/github-webhook/releases #github release如果下载太慢可以试试这个 wget http://img.sgfoot.com/github-webhook1.4.1.linux-amd64.tar.gz 3、解压安装
tar -zxvf github-webhook1.4.1.linux-amd64.tar.gz cp github-webhook /usr/bin/ chmod u&#43;x /usr/bin/github-webhook cd /usr/bin 4、启动webhook,我这里是使用后台运行的方式
nohup github-webhook -b /www/wwwroot/github-webhook-shell.sh -s yourself-secret &amp; 这里的-b后面的路径是拉取github内容的脚本; -s 后面的是密码，也是github那边的webhook设置的密码，随便设置，两边到时候保持一致就可以了
#! /bin/bash git --git-dir=&#34;/www/wwwroot/120.25.194.155-520/kevinbin123.github.io/.git&#34; --work-tree=&#34;/www/wwwroot/120.25.194.155-520/kevinbin123.github.io&#34; pull origin hugo exit 0 5、测试是否web-hook能通(ip换成自己的服务器ip)
http://ip:2020/ping ps，处理阿里云那边的防火墙要开端口，自己的服务器的防火墙端口也要开放（一下是centos8开端口的方法）
firewall-cmd --list-all firewall-cmd --add-port=2020/tcp --permanent firewall-cmd --reload firewall-cmd --list-all 6、生成公钥配置到github上
ssh-keygen -t rsa cat .ssh/id_rsa.pub 复制代码 然后复制到github的settings-&gt;SSH and GPG keys上 7、进入到自己的服务器的网站路径下，我这边是因为安装了宝塔，直接建了一个网站;把gitHub上的内容先clone下来" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/tecs/%E5%88%A9%E7%94%A8webhook%E5%B0%86github%E4%B8%8A%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%90%8C%E6%AD%A5%E5%88%B0%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%B0%E5%BD%95/" /><meta property="article:section" content="tecs" />
<meta property="article:published_time" content="2021-11-08T23:21:28+08:00" />
<meta property="article:modified_time" content="2021-11-08T23:21:28+08:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="abin" /></a>
      <h1>abin の 成长之路</h1>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">首页</a>
             - 
          
          <a class="app-header-menu-item" href="/tecs/">学习</a>
             - 
          
          <a class="app-header-menu-item" href="/note/">笔记</a>
      </nav>
      <p>A man as good as me should have lived a glorious life</p>
      <div class="app-header-social">
        
          <a href="https://github.com/kevinbin123" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="http://ecoder.xyz:520/" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-cloud">
  <title>mySite</title>
  <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">利用webhook将github上的博客同步到阿里云服务器记录</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Nov 8, 2021
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          1 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>写在前面，如何用hugo搭建博客并推送到github，可以参考前文<a href="/tecs/windows%E4%B8%8A%E5%AE%89%E8%A3%85hugo%E5%B9%B6%E4%B8%94%E6%8E%A8%E9%80%81%E5%88%B0github%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/">Windows上安装hugo并且推送到github过程记录</a></p>
<p>本文主要记录，从windows创建好的博文推送到github之后，如何利用webhook，从github拉取到阿里云服务器上</p>
<p>1、服务器上安装git工具</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">yum install git
<span style="color:#75715e">#安装好之后，查看是否安装成功</span>
git --version
</code></pre></div><p>2、下载github-webhook工具</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#到这个网站找最新的</span>
https://github.com/yezihack/github-webhook/releases
<span style="color:#75715e">#github release如果下载太慢可以试试这个</span>
wget http://img.sgfoot.com/github-webhook1.4.1.linux-amd64.tar.gz
</code></pre></div><p>3、解压安装</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tar -zxvf github-webhook1.4.1.linux-amd64.tar.gz 
cp github-webhook /usr/bin/
chmod u+x /usr/bin/github-webhook
cd /usr/bin
</code></pre></div><p>4、启动webhook,我这里是使用后台运行的方式</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">nohup github-webhook -b /www/wwwroot/github-webhook-shell.sh -s yourself-secret &amp;
</code></pre></div><p>这里的-b后面的路径是拉取github内容的脚本; -s 后面的是密码，也是github那边的webhook设置的密码，随便设置，两边到时候保持一致就可以了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#! /bin/bash
</span><span style="color:#75715e"></span>git --git-dir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/www/wwwroot/120.25.194.155-520/kevinbin123.github.io/.git&#34;</span> --work-tree<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/www/wwwroot/120.25.194.155-520/kevinbin123.github.io&#34;</span> pull origin hugo
exit <span style="color:#ae81ff">0</span>
</code></pre></div><p>5、测试是否web-hook能通(ip换成自己的服务器ip)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">http://ip:2020/ping
</code></pre></div><p>ps，处理阿里云那边的防火墙要开端口，自己的服务器的防火墙端口也要开放（一下是centos8开端口的方法）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">firewall-cmd --list-all
firewall-cmd --add-port<span style="color:#f92672">=</span>2020/tcp --permanent
firewall-cmd --reload
firewall-cmd --list-all
</code></pre></div><p>6、生成公钥配置到github上</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">ssh-keygen -t rsa
cat .ssh/id_rsa.pub
复制代码
然后复制到github的settings-&gt;SSH and GPG keys上
</code></pre></div><p>7、进入到自己的服务器的网站路径下，我这边是因为安装了宝塔，直接建了一个网站;把gitHub上的内容先clone下来</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cd /www/wwwroot/120.25.194.155-520/
git clone -b hugo git@github.com:kevinbin123/kevinbin123.github.io.git
</code></pre></div><p>8、登录github添加webhook</p>
<p><img src="https://gitee.com/kevinbin/pics/raw/master/imgs/%E6%8D%95%E8%8E%B7.PNG" alt=""></p>
<p>9、写博客推送，发现推送过去到服务器的链接全部都是github里面的链接；后来发现原先在生成博文的时候有指定这个baseUrl;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">用cmd执行
hugo --baseUrl<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://kevinbin123.github.io/&#34;</span>  --buildDrafts
</code></pre></div><p>修改hugo下的config.toml;将baseURL指定为/这样；然后生成博文的时候也不要加&ndash;baseUrl；这样生成到github,以及阿里云服务器上的博客就都没有指定域名，而是根据github或者服务器自己的域名来的了。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">baseURL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/&#39;</span>
</code></pre></div><h2 id="参考文献">参考文献</h2>
<blockquote>
<p><a href="https://github.com/yezihack/github-webhook">https://github.com/yezihack/github-webhook</a></p>
<p><a href="https://www.cnblogs.com/300js/p/12767431.html">https://www.cnblogs.com/300js/p/12767431.html</a></p>
<p><a href="https://www.jianshu.com/p/ea2c3b2827ef">https://www.jianshu.com/p/ea2c3b2827ef</a></p>
</blockquote>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>

<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    

    <title>Gin&#43;vue2博客笔记（后端） | abin の 成长之路</title>
    <meta property="og:title" content="Gin&#43;vue2博客笔记（后端） - abin の 成长之路">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2022-08-14T23:44:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2022-08-14T23:44:00&#43;08:00'>
        
    <meta name="Keywords" content="golang,go语言,go语言笔记,博客,项目管理,软件架构">
    <meta name="description" content="Gin&#43;vue2博客笔记（后端）">
        
    <meta name="author" content="abin">
    <meta property="og:url" content="https://kevinbin123.github.io/post/gin&#43;vue2%E5%8D%9A%E5%AE%A2%E7%AC%94%E8%AE%B0%E5%90%8E%E7%AB%AF/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
        <link rel="stylesheet" href='/css/sidebar_menu.css'>
    
</head>

<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://kevinbin123.github.io/">
                        abin の 成长之路
                    </a>
                
                <p class="description">冉冉升起的码神</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://kevinbin123.github.io/">首页</a>
                    
                    <a  href="https://kevinbin123.github.io/archives/" title="归档">归档</a>
                    
                    <a  href="https://kevinbin123.github.io/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Gin&#43;vue2博客笔记（后端）</h1>
        </header>
        
  <time datetime="2022-08-14T15:44:00Z" class="post-meta meta-date dt-published">
    2022年8月14日
  </time>


<div class="post-meta meta-category">
  <span>&nbsp;|</span>
  
    <a href='/categories/Golang' target="_blank">Golang</a>
  
</div>


        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">&nbsp;|
                <span id="busuanzi_value_page_pv"></span> <span>阅读</span>
            </span>
        </div>
        
        
        <div class="post-content">
            <h1 id="ginvue2博客笔记后端">gin+vue2博客笔记（后端）</h1>
<h2 id="写在前面">写在前面</h2>
<p>记录一下，这个是一个博客系统，后端使用的是gin框架编写；前端包含管理页面和前台展示页面，使用的是vue2版本；</p>
<p>参考的是B站的一位大佬的视频：</p>
<blockquote>
<p><a href="https://www.bilibili.com/video/BV1AA411v7e6">https://www.bilibili.com/video/BV1AA411v7e6</a></p>
</blockquote>
<h2 id="搭建框架">搭建框架</h2>
<p>1、创建ginblog的项目</p>
<p>2、创建相关文件夹</p>
<pre tabindex="0"><code>├─ main.go //主程序      
├─api      //路由   
├─config // 项目配置入口   
├─database  // 数据库备份文件（初始化）
├─log  // 项目日志
├─middleware  // 中间件
├─model // 数据模型层
├─routes   	//路由路口
├─static // 打包静态文件         
├─upload   
├─utils // 项目公用工具库        
└─web // 前端开发源码
</code></pre><h2 id="加载配置和链接数据库">加载配置和链接数据库</h2>
<p>1、创建<code>config/config.ini</code>配置文件</p>
<pre tabindex="0"><code class="language-in" data-lang="in">[server]
AppMode = debug
HttpPort = :3000
JwtKey = abcd3efg
[database]
DB = mysql
DbHost = localhost
DbPort = 3306
DbUser = root
DbPassWord = 123456
DbName = ginblog
</code></pre><p>2、加载配置，创建<code>utils/setting.go</code></p>
<p>使用第三方库来读取ini文件<code>go get -u gopkg.in/ini.v1 </code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">utils</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;gopkg.in/ini.v1&#34;</span>
)

<span style="color:#66d9ef">var</span> (
	<span style="color:#a6e22e">AppMode</span>    <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">HttpPort</span>   <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">JwtKey</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DB</span>         <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbHost</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbPort</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbUser</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbPassWord</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbName</span>     <span style="color:#66d9ef">string</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">init</span>() {
	<span style="color:#a6e22e">cfg</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ini</span>.<span style="color:#a6e22e">Load</span>(<span style="color:#e6db74">&#34;config/config.ini&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;读取配置文件出错，请检查文件路径：&#34;</span>, <span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span>
	}
	<span style="color:#a6e22e">LoadServer</span>(<span style="color:#a6e22e">cfg</span>)
	<span style="color:#a6e22e">LoadDatabase</span>(<span style="color:#a6e22e">cfg</span>)

}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoadServer</span>(<span style="color:#a6e22e">file</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ini</span>.<span style="color:#a6e22e">File</span>) {
	<span style="color:#a6e22e">AppMode</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;server&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;AppMode&#34;</span>).<span style="color:#a6e22e">MustString</span>(<span style="color:#e6db74">&#34;debug&#34;</span>)
	<span style="color:#a6e22e">HttpPort</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;server&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;HttpPort&#34;</span>).<span style="color:#a6e22e">MustString</span>(<span style="color:#e6db74">&#34;:3000&#34;</span>)
	<span style="color:#a6e22e">JwtKey</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;server&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;JwtKey&#34;</span>).<span style="color:#a6e22e">MustString</span>(<span style="color:#e6db74">&#34;abcd3efg&#34;</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoadDatabase</span>(<span style="color:#a6e22e">file</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ini</span>.<span style="color:#a6e22e">File</span>) {
	<span style="color:#a6e22e">DB</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DB&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbHost</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbHost&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbPort</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbPort&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbUser</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbUser&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbPassWord</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbPassWord&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbName</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbName&#34;</span>).<span style="color:#a6e22e">String</span>()
}

</code></pre></div><p>3、使用gorm框架来链接mysql数据库，<code>go get -u gorm.io/gorm</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils&#34;</span>
	<span style="color:#e6db74">&#34;gorm.io/driver/mysql&#34;</span>
	<span style="color:#e6db74">&#34;gorm.io/gorm&#34;</span>
	<span style="color:#e6db74">&#34;gorm.io/gorm/schema&#34;</span>
	<span style="color:#e6db74">&#34;time&#34;</span>
)

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">db</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DB</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">InitDb</span>() {
	<span style="color:#a6e22e">timeout</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;10s&#34;</span>
	<span style="color:#a6e22e">dsn</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%s:%s@tcp(%s:%s)/%s?charset=utf8&amp;parseTime=True&amp;loc=Local&amp;timeout=%s&#34;</span>, <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">DbUser</span>, <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">DbPassWord</span>, <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">DbHost</span>, <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">DbPort</span>, <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">DbName</span>, <span style="color:#a6e22e">timeout</span>)
	<span style="color:#75715e">//连接MYSQL, 获得DB类型实例，用于后面的数据库读写操作。
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">db</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">mysql</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">dsn</span>), <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Config</span>{
		<span style="color:#a6e22e">NamingStrategy</span>: <span style="color:#a6e22e">schema</span>.<span style="color:#a6e22e">NamingStrategy</span>{
			<span style="color:#a6e22e">SingularTable</span>: <span style="color:#66d9ef">true</span>,
		},
	})
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		panic(<span style="color:#e6db74">&#34;连接数据库失败, error=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
	}

	<span style="color:#a6e22e">sqldb</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">DB</span>()
	<span style="color:#a6e22e">sqldb</span>.<span style="color:#a6e22e">SetMaxIdleConns</span>(<span style="color:#ae81ff">10</span>)
	<span style="color:#a6e22e">sqldb</span>.<span style="color:#a6e22e">SetMaxOpenConns</span>(<span style="color:#ae81ff">100</span>)
	<span style="color:#a6e22e">sqldb</span>.<span style="color:#a6e22e">SetConnMaxLifetime</span>(<span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>)
	<span style="color:#75715e">//defer sqldb.Close()
</span><span style="color:#75715e"></span>
}
</code></pre></div><h2 id="启动服务器">启动服务器</h2>
<p>1、创建<code>routers/router.go</code>文件</p>
<p>需要先<code>go get -u github.com/gin-gonic/gin</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">routers</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/utils&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
)
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">InitRouter</span>() {
	<span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">SetMode</span>(<span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">AppMode</span>)
	<span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">New</span>()
	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">HttpPort</span>)
}

</code></pre></div><p>2、在main中添加路由和加载配置的操作</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/model&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/routers&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">InitDb</span>()
	<span style="color:#a6e22e">routers</span>.<span style="color:#a6e22e">InitRouter</span>()
}
</code></pre></div><h2 id="定义数据">定义数据</h2>
<p>1、创建<code>model/user.go</code>，定义用户的结构</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;gorm.io/gorm&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
	<span style="color:#a6e22e">Username</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(20);not null&#34; json:&#34;username&#34; validate:&#34;required,min=4,max=12&#34; label:&#34;用户名&#34;`</span>
	<span style="color:#a6e22e">Password</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(20);not null&#34; json:&#34;password&#34; validate:&#34;required,min=6,max=20&#34; label:&#34;密码&#34;`</span>
	<span style="color:#a6e22e">Role</span>     <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;type:int;DEFAULT 2&#34; json:&#34;role&#34; validate:&#34;required,gte=2&#34; label:&#34;角色码&#34;`</span>
}
</code></pre></div><p>2、创建<code>model/category.go</code>，定义文章分类的结构</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Category</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">ID</span>   <span style="color:#66d9ef">uint</span>   <span style="color:#e6db74">`gorm:&#34;primary_key;auto_increment&#34; json:&#34;id&#34;`</span>
	<span style="color:#a6e22e">Name</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(20);not null&#34; json:&#34;name&#34;`</span>
}
</code></pre></div><p>3、创建<code>model/Article.go</code>文件，定义文章结构</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;gorm.io/gorm&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Article</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Category</span> <span style="color:#a6e22e">Category</span> <span style="color:#e6db74">`gorm:&#34;foreignkey:Cid&#34;`</span>
	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
	<span style="color:#a6e22e">Title</span>        <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(100);not null&#34; json:&#34;title&#34;`</span>
	<span style="color:#a6e22e">Cid</span>          <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;type:int;not null&#34; json:&#34;cid&#34;`</span>
	<span style="color:#a6e22e">Desc</span>         <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;desc&#34;`</span>
	<span style="color:#a6e22e">Content</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:longtext&#34; json:&#34;content&#34;`</span>
	<span style="color:#a6e22e">Img</span>          <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(100)&#34; json:&#34;img&#34;`</span>
	<span style="color:#a6e22e">CommentCount</span> <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;type:int;not null;default:0&#34; json:&#34;comment_count&#34;`</span>
	<span style="color:#a6e22e">ReadCount</span>    <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;type:int;not null;default:0&#34; json:&#34;read_count&#34;`</span>
}
</code></pre></div><p>4、创建<code>model/profile.go</code>，定义个人简介结构</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Profile</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">ID</span>        <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;primaryKey&#34; json:&#34;id&#34;`</span>
	<span style="color:#a6e22e">Name</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(20)&#34; json:&#34;name&#34;`</span>
	<span style="color:#a6e22e">Desc</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;desc&#34;`</span>
	<span style="color:#a6e22e">Qqchat</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;qq_chat&#34;`</span>
	<span style="color:#a6e22e">Wechat</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(100)&#34; json:&#34;wechat&#34;`</span>
	<span style="color:#a6e22e">Weibo</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;weibo&#34;`</span>
	<span style="color:#a6e22e">Bili</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;bili&#34;`</span>
	<span style="color:#a6e22e">Email</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;email&#34;`</span>
	<span style="color:#a6e22e">Img</span>       <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;img&#34;`</span>
	<span style="color:#a6e22e">Avatar</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;avatar&#34;`</span>
	<span style="color:#a6e22e">IcpRecord</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;icp_record&#34;`</span>
}
</code></pre></div><p>5、创建<code>model/comment.go</code>，定义评论结构</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;gorm.io/gorm&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Comment</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
	<span style="color:#a6e22e">UserId</span>    <span style="color:#66d9ef">uint</span>   <span style="color:#e6db74">`json:&#34;user_id&#34;`</span>
	<span style="color:#a6e22e">ArticleId</span> <span style="color:#66d9ef">uint</span>   <span style="color:#e6db74">`json:&#34;article_id&#34;`</span>
	<span style="color:#a6e22e">Title</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;article_title&#34;`</span>
	<span style="color:#a6e22e">Username</span>  <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;username&#34;`</span>
	<span style="color:#a6e22e">Content</span>   <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(500);not null;&#34; json:&#34;content&#34;`</span>
	<span style="color:#a6e22e">Status</span>    <span style="color:#66d9ef">int8</span>   <span style="color:#e6db74">`gorm:&#34;type:tinyint;default:2&#34; json:&#34;status&#34;`</span>
}
</code></pre></div><p>6、修改<code>model/db.go</code>，添加自动创建数据库的功能</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">AutoMigrate</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{}, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Article</span>{}, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Category</span>{}, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Profile</span>{}, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Comment</span>{})
</code></pre></div><p>7、定义错误代码，添加<code>utils/errmsg/errMsg.go</code>文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">errmsg</span>

<span style="color:#66d9ef">const</span> (
	<span style="color:#a6e22e">SUCCSE</span> = <span style="color:#ae81ff">200</span>
	<span style="color:#a6e22e">ERROR</span>  = <span style="color:#ae81ff">500</span>

	<span style="color:#75715e">// code= 1000... 用户模块的错误
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">ERROR_USERNAME_USED</span>    = <span style="color:#ae81ff">1001</span>
	<span style="color:#a6e22e">ERROR_PASSWORD_WRONG</span>   = <span style="color:#ae81ff">1002</span>
	<span style="color:#a6e22e">ERROR_USER_NOT_EXIST</span>   = <span style="color:#ae81ff">1003</span>
	<span style="color:#a6e22e">ERROR_TOKEN_EXIST</span>      = <span style="color:#ae81ff">1004</span>
	<span style="color:#a6e22e">ERROR_TOKEN_RUNTIME</span>    = <span style="color:#ae81ff">1005</span>
	<span style="color:#a6e22e">ERROR_TOKEN_WRONG</span>      = <span style="color:#ae81ff">1006</span>
	<span style="color:#a6e22e">ERROR_TOKEN_TYPE_WRONG</span> = <span style="color:#ae81ff">1007</span>
	<span style="color:#a6e22e">ERROR_USER_NO_RIGHT</span>    = <span style="color:#ae81ff">1008</span>
	<span style="color:#75715e">// code= 2000... 文章模块的错误
</span><span style="color:#75715e"></span>
	<span style="color:#a6e22e">ERROR_ART_NOT_EXIST</span> = <span style="color:#ae81ff">2001</span>
	<span style="color:#75715e">// code= 3000... 分类模块的错误
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">ERROR_CATENAME_USED</span>  = <span style="color:#ae81ff">3001</span>
	<span style="color:#a6e22e">ERROR_CATE_NOT_EXIST</span> = <span style="color:#ae81ff">3002</span>
)

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">codeMsg</span> = <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#66d9ef">string</span>{
	<span style="color:#a6e22e">SUCCSE</span>:                 <span style="color:#e6db74">&#34;OK&#34;</span>,
	<span style="color:#a6e22e">ERROR</span>:                  <span style="color:#e6db74">&#34;FAIL&#34;</span>,
	<span style="color:#a6e22e">ERROR_USERNAME_USED</span>:    <span style="color:#e6db74">&#34;用户名已存在&#34;</span>,
	<span style="color:#a6e22e">ERROR_PASSWORD_WRONG</span>:   <span style="color:#e6db74">&#34;密码错误&#34;</span>,
	<span style="color:#a6e22e">ERROR_USER_NOT_EXIST</span>:   <span style="color:#e6db74">&#34;用户不存在&#34;</span>,
	<span style="color:#a6e22e">ERROR_TOKEN_EXIST</span>:      <span style="color:#e6db74">&#34;token不存在，请重新登录&#34;</span>,
	<span style="color:#a6e22e">ERROR_TOKEN_RUNTIME</span>:    <span style="color:#e6db74">&#34;token已过期，请重新登录&#34;</span>,
	<span style="color:#a6e22e">ERROR_TOKEN_WRONG</span>:      <span style="color:#e6db74">&#34;token不正确，请重新登录&#34;</span>,
	<span style="color:#a6e22e">ERROR_TOKEN_TYPE_WRONG</span>: <span style="color:#e6db74">&#34;token格式错误，请重新登录&#34;</span>,
	<span style="color:#a6e22e">ERROR_USER_NO_RIGHT</span>:    <span style="color:#e6db74">&#34;该用户无权限&#34;</span>,
	<span style="color:#a6e22e">ERROR_ART_NOT_EXIST</span>:    <span style="color:#e6db74">&#34;文章不存在&#34;</span>,
	<span style="color:#a6e22e">ERROR_CATENAME_USED</span>:    <span style="color:#e6db74">&#34;该分类已存在&#34;</span>,
	<span style="color:#a6e22e">ERROR_CATE_NOT_EXIST</span>:   <span style="color:#e6db74">&#34;该分类不存在&#34;</span>,
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">string</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">codeMsg</span>[<span style="color:#a6e22e">code</span>]
}
</code></pre></div><h2 id="编写api">编写api</h2>
<h3 id="实现文章相关api">实现文章相关api</h3>
<blockquote>
<p>文章模块需要实现的功能：</p>
<p>添加文章、查询单个文章信息、查询分类下的所有文章、查询文章列表、编辑文章、删除文章</p>
</blockquote>
<p>1、在<code>model/Article.go</code>中先实现相关查询数据库的操作</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;gorm.io/gorm&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Article</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Category</span> <span style="color:#a6e22e">Category</span> <span style="color:#e6db74">`gorm:&#34;foreignkey:Cid&#34;`</span>
	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
	<span style="color:#a6e22e">Title</span>        <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(100);not null&#34; json:&#34;title&#34;`</span>
	<span style="color:#a6e22e">Cid</span>          <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;type:int;not null&#34; json:&#34;cid&#34;`</span>
	<span style="color:#a6e22e">Desc</span>         <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;desc&#34;`</span>
	<span style="color:#a6e22e">Content</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:longtext&#34; json:&#34;content&#34;`</span>
	<span style="color:#a6e22e">Img</span>          <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(100)&#34; json:&#34;img&#34;`</span>
	<span style="color:#a6e22e">CommentCount</span> <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;type:int;not null;default:0&#34; json:&#34;comment_count&#34;`</span>
	<span style="color:#a6e22e">ReadCount</span>    <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;type:int;not null;default:0&#34; json:&#34;read_count&#34;`</span>
}

<span style="color:#75715e">//添加文章
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CreateArticle</span>(<span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Article</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//todo  查询单个文章
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetArtInfo</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) (<span style="color:#a6e22e">Article</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">art</span> <span style="color:#a6e22e">Article</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Preload</span>(<span style="color:#e6db74">&#34;Category&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">art</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">art</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_ART_NOT_EXIST</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">art</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//todo 查询分类下的所有文章
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCateArt</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">pagesize</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">pagenum</span> <span style="color:#66d9ef">int</span>) ([]<span style="color:#a6e22e">Article</span>, <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">int64</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cateArticles</span> []<span style="color:#a6e22e">Article</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">total</span> <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Preload</span>(<span style="color:#e6db74">&#34;Category&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;cid = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Limit</span>(<span style="color:#a6e22e">pagesize</span>).<span style="color:#a6e22e">Offset</span>((<span style="color:#a6e22e">pagenum</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">pagesize</span>).<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cateArticles</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cateArticles</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;cid =?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">ErrRecordNotFound</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_CATE_NOT_EXIST</span>, <span style="color:#ae81ff">0</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cateArticles</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>, <span style="color:#a6e22e">total</span>
}

<span style="color:#75715e">//查询文章列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetArticles</span>(<span style="color:#a6e22e">title</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">pageNum</span> <span style="color:#66d9ef">int</span>) ([]<span style="color:#a6e22e">Article</span>, <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">int64</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">datas</span> []<span style="color:#a6e22e">Article</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">total</span> <span style="color:#66d9ef">int64</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">title</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
		<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Debug</span>().<span style="color:#a6e22e">Order</span>(<span style="color:#e6db74">&#34;Updated_At DESC&#34;</span>).<span style="color:#a6e22e">Preload</span>(<span style="color:#e6db74">&#34;Category&#34;</span>).<span style="color:#a6e22e">Limit</span>(<span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Offset</span>((<span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">datas</span>).<span style="color:#a6e22e">Error</span>
		<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">datas</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">ErrRecordNotFound</span> {
			<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>, <span style="color:#ae81ff">0</span>
		}
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">datas</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>, <span style="color:#a6e22e">total</span>
	}
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Order</span>(<span style="color:#e6db74">&#34;Updated_At DESC&#34;</span>).<span style="color:#a6e22e">Preload</span>(<span style="color:#e6db74">&#34;Category&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;title LIKE ?&#34;</span>, <span style="color:#a6e22e">title</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;%&#34;</span>).<span style="color:#a6e22e">Limit</span>(<span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Offset</span>((<span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">datas</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">datas</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;title LIKE ?&#34;</span>, <span style="color:#a6e22e">title</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;%&#34;</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">ErrRecordNotFound</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>, <span style="color:#ae81ff">0</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">datas</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>, <span style="color:#a6e22e">total</span>
}

<span style="color:#75715e">//编辑文章
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">EditArticle</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Article</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">maps</span> = make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{})
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;title&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Title</span>
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;cid&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Cid</span>
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;desc&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Desc</span>
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;content&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Content</span>
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;img&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Img</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Article</span>{}).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Updates</span>(<span style="color:#a6e22e">maps</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//删除文章
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DeleteArticle</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Delete</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Article</span>{}).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}
</code></pre></div><p>2、创建<code>api/v1/article.go</code>，实现api接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">v1</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/model&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;strconv&#34;</span>
)

<span style="color:#75715e">//todo 查询单个文章
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetArtInfo</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetArtInfo</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">// todo 查询某个分类下的文章
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCateArt</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagesize&#34;</span>))
	<span style="color:#a6e22e">pageNum</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagenum&#34;</span>))
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">pageNum</span> = <span style="color:#ae81ff">1</span>
	}
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span>, <span style="color:#a6e22e">total</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetCateArt</span>(<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">pageNum</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
		<span style="color:#e6db74">&#34;total&#34;</span>:   <span style="color:#a6e22e">total</span>,
	})
}

<span style="color:#75715e">//添加文章
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">AddArticle</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">Article</span>
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CreateArticle</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)

	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">//查询文章列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetArticles</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagesize&#34;</span>))
	<span style="color:#a6e22e">pageNum</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagenum&#34;</span>))
	<span style="color:#a6e22e">title</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;title&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">pageNum</span> = <span style="color:#ae81ff">1</span>
	}
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span>, <span style="color:#a6e22e">total</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetArticles</span>(<span style="color:#a6e22e">title</span>, <span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">pageNum</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
		<span style="color:#e6db74">&#34;total&#34;</span>:   <span style="color:#a6e22e">total</span>,
	})
}

<span style="color:#75715e">//编辑文章
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">EditArticle</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">Article</span>
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)

	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">EditArticle</span>(<span style="color:#a6e22e">id</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)

	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">//删除文章
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DeleteArticle</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">DeleteArticle</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

</code></pre></div><p>3、在<code>routers/router.go</code>中添加文章相关的路由</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">router</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	{
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;articles&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetArticles</span>) <span style="color:#75715e">//获取所有文章
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;article/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetArtInfo</span>) <span style="color:#75715e">//获取某个文章的信息
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;article/catelist/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCateArt</span>) <span style="color:#75715e">//获取某个分类下的文章
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;article/add&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">AddArticle</span>)	<span style="color:#75715e">//添加文章
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;article/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">EditArticle</span>)	<span style="color:#75715e">//编辑文章
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#e6db74">&#34;article/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">DeleteArticle</span>)  <span style="color:#75715e">//删除文章
</span><span style="color:#75715e"></span>	}
</code></pre></div><h3 id="实现分类相关api">实现分类相关api</h3>
<blockquote>
<p>分类模块需要实现的功能：</p>
<p>查询分类是否存在、添加分类、查询单个分类信息、查询分类列表、编辑分类、删除分类</p>
</blockquote>
<p>1、在<code>model/Category.go</code>中先实现相关查询数据库的操作</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;gorm.io/gorm&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Category</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">ID</span>   <span style="color:#66d9ef">uint</span>   <span style="color:#e6db74">`gorm:&#34;primary_key;auto_increment&#34; json:&#34;id&#34;`</span>
	<span style="color:#a6e22e">Name</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(20);not null&#34; json:&#34;name&#34;`</span>
}

<span style="color:#75715e">//查询分类是否存在
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CheckCategory</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cate</span> <span style="color:#a6e22e">Category</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Select</span>(<span style="color:#e6db74">&#34;id&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;name = ?&#34;</span>, <span style="color:#a6e22e">name</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cate</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">cate</span>.<span style="color:#a6e22e">ID</span> &gt; <span style="color:#ae81ff">0</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_CATENAME_USED</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//添加分类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CreateCategory</span>(<span style="color:#a6e22e">cate</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Category</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cate</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//查询单个分类信息
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCateInfo</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) (<span style="color:#a6e22e">Category</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cate</span> <span style="color:#a6e22e">Category</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cate</span>)
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cate</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//查询分类列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCategorys</span>(<span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">pageNum</span> <span style="color:#66d9ef">int</span>) ([]<span style="color:#a6e22e">Category</span>, <span style="color:#66d9ef">int64</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cates</span> []<span style="color:#a6e22e">Category</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">total</span> <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Limit</span>(<span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Offset</span>((<span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cates</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cates</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">ErrRecordNotFound</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#ae81ff">0</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cates</span>, <span style="color:#a6e22e">total</span>
}

<span style="color:#75715e">//编辑分类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">EditCategory</span>(<span style="color:#a6e22e">cateid</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">category</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Category</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">maps</span> = make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{})
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;name&#34;</span>] = <span style="color:#a6e22e">category</span>.<span style="color:#a6e22e">Name</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Category</span>{}).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">cateid</span>).<span style="color:#a6e22e">Updates</span>(<span style="color:#a6e22e">maps</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//删除分类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DeleteCategory</span>(<span style="color:#a6e22e">cateid</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">cateid</span>).<span style="color:#a6e22e">Delete</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Category</span>{}).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}
</code></pre></div><p>2、创建<code>api/v1/category.go</code>，实现api接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">v1</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/model&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;strconv&#34;</span>
)

<span style="color:#75715e">//添加分类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">AddCategory</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">Category</span>
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CheckCategory</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Name</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span> {
		<span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CreateCategory</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	}
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">//查询单个分类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCateInfo</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetCateInfo</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">//查询分类列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCategorys</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagesize&#34;</span>))
	<span style="color:#a6e22e">pageNum</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagenum&#34;</span>))

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">pageNum</span> = <span style="color:#ae81ff">1</span>
	}
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">total</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetCategorys</span>(<span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">pageNum</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
		<span style="color:#e6db74">&#34;total&#34;</span>:   <span style="color:#a6e22e">total</span>,
	})
}

<span style="color:#75715e">//编辑分类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">EditCategory</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">Category</span>
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CheckCategory</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Name</span>)

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span> {
		<span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">EditCategory</span>(<span style="color:#a6e22e">id</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_CATENAME_USED</span> {
		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Abort</span>()
	}
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">//删除分类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DeleteCategory</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">DeleteCategory</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}
</code></pre></div><p>3、在<code>routers/router.go</code>中添加分类相关的路由</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">router</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	{
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;categorys&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCategorys</span>)	<span style="color:#75715e">//获取分类列表
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;category/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCateInfo</span>)	<span style="color:#75715e">//获取某个分类的信息
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;category/add&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">AddCategory</span>)	<span style="color:#75715e">//添加分类
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;category/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">EditCategory</span>)	<span style="color:#75715e">//编辑某个分类
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#e6db74">&#34;category/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">DeleteCategory</span>)	<span style="color:#75715e">//删除某个分类
</span><span style="color:#75715e"></span>	}
</code></pre></div><h3 id="实现评论相关api">实现评论相关api</h3>
<blockquote>
<p>评论模块需要实现的功能：</p>
<p>添加评论、查询单个评论、获取所有评论列表、获取评论数量、获取某个文章下所有的评论列表、删除评论、通过评论、撤下评论</p>
</blockquote>
<p>1、在<code>model/Comment.go</code>中先实现相关查询数据库的操作</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;gorm.io/gorm&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Comment</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
	<span style="color:#a6e22e">UserId</span>    <span style="color:#66d9ef">uint</span>   <span style="color:#e6db74">`json:&#34;user_id&#34;`</span>
	<span style="color:#a6e22e">ArticleId</span> <span style="color:#66d9ef">uint</span>   <span style="color:#e6db74">`json:&#34;article_id&#34;`</span>
	<span style="color:#a6e22e">Title</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;article_title&#34;`</span>
	<span style="color:#a6e22e">Username</span>  <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;username&#34;`</span>
	<span style="color:#a6e22e">Content</span>   <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(500);not null;&#34; json:&#34;content&#34;`</span>
	<span style="color:#a6e22e">Status</span>    <span style="color:#66d9ef">int8</span>   <span style="color:#e6db74">`gorm:&#34;type:tinyint;default:2&#34; json:&#34;status&#34;`</span>
}

<span style="color:#75715e">// AddComment 新增评论
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">AddComment</span>(<span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Comment</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">// GetComment 查询单个评论
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetComment</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) (<span style="color:#a6e22e">Comment</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">comment</span> <span style="color:#a6e22e">Comment</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comment</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">comment</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">comment</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">// GetCommentList 后台所有获取评论列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCommentList</span>(<span style="color:#a6e22e">pagesize</span>, <span style="color:#a6e22e">pagenum</span> <span style="color:#66d9ef">int</span>) ([]<span style="color:#a6e22e">Comment</span>, <span style="color:#66d9ef">int64</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">comments</span> []<span style="color:#a6e22e">Comment</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">total</span> <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comments</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comments</span>).<span style="color:#a6e22e">Limit</span>(<span style="color:#a6e22e">pagesize</span>).<span style="color:#a6e22e">Offset</span>((<span style="color:#a6e22e">pagenum</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">pagesize</span>).<span style="color:#a6e22e">Order</span>(<span style="color:#e6db74">&#34;Created_At DESC&#34;</span>).<span style="color:#a6e22e">Select</span>(<span style="color:#e6db74">&#34;comment.id, article.title,user_id,article_id, user.username, comment.content, comment.status,comment.created_at,comment.deleted_at&#34;</span>).<span style="color:#a6e22e">Joins</span>(<span style="color:#e6db74">&#34;left join article on article.id = comment.article_id&#34;</span>).<span style="color:#a6e22e">Joins</span>(<span style="color:#e6db74">&#34;left join user on user.id = comment.user_id&#34;</span>).<span style="color:#a6e22e">Scan</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comments</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">comments</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">comments</span>, <span style="color:#a6e22e">total</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">// GetCommentCount 获取评论数量
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCommentCount</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int64</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">comment</span> <span style="color:#a6e22e">Comment</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">total</span> <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comment</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;article_id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;status = ?&#34;</span>, <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">total</span>
}

<span style="color:#75715e">// GetCommentListFront 展示页面获取评论列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCommentListFront</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">pagesize</span>, <span style="color:#a6e22e">pagenum</span> <span style="color:#66d9ef">int</span>) ([]<span style="color:#a6e22e">Comment</span>, <span style="color:#66d9ef">int64</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">comments</span> []<span style="color:#a6e22e">Comment</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">total</span> <span style="color:#66d9ef">int64</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Debug</span>().<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Comment</span>{}).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;article_id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;status = ?&#34;</span>, <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
	<span style="color:#75715e">//err := db.Debug().Model(&amp;Comment{}).Limit(pagesize).Offset((pagenum-1)*pagesize).Order(&#34;Created_At DESC&#34;).Select(&#34;comment.id, article.title,user_id,article_id, user.username, comment.content, comment.status,comment.created_at,comment.deleted_at&#34;).Joins(&#34;left join article on article.id = comment.article_id&#34;).Joins(&#34;left join user on user.id = comment.user_id&#34;).Scan(&amp;comments).Where(&#34;article_id = ?&#34;, id).Where(&#34;status = ?&#34;, 1).Error
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Debug</span>().<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Comment</span>{}).<span style="color:#a6e22e">Limit</span>(<span style="color:#a6e22e">pagesize</span>).<span style="color:#a6e22e">Offset</span>((<span style="color:#a6e22e">pagenum</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span><span style="color:#a6e22e">pagesize</span>).<span style="color:#a6e22e">Order</span>(<span style="color:#e6db74">&#34;Created_At DESC&#34;</span>).<span style="color:#a6e22e">Select</span>(<span style="color:#e6db74">&#34;comment.id, article.title, user_id, article_id, user.username, comment.content, comment.status,comment.created_at,comment.deleted_at&#34;</span>).<span style="color:#a6e22e">Joins</span>(<span style="color:#e6db74">&#34;LEFT JOIN article ON comment.article_id = article.id&#34;</span>).<span style="color:#a6e22e">Joins</span>(<span style="color:#e6db74">&#34;LEFT JOIN user ON comment.user_id = user.id&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;article_id = ?&#34;</span>,
		<span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;status = ?&#34;</span>, <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">Scan</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comments</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">comments</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">comments</span>, <span style="color:#a6e22e">total</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">// DeleteComment 删除评论
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DeleteComment</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">comment</span> <span style="color:#a6e22e">Comment</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Delete</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comment</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">// CheckComment 通过评论
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CheckComment</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Comment</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">comment</span> <span style="color:#a6e22e">Comment</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#a6e22e">Comment</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">article</span> <span style="color:#a6e22e">Article</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">maps</span> = make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{})
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;status&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Status</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comment</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Updates</span>(<span style="color:#a6e22e">maps</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">res</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">article</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">ArticleId</span>).<span style="color:#a6e22e">UpdateColumn</span>(<span style="color:#e6db74">&#34;comment_count&#34;</span>, <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Expr</span>(<span style="color:#e6db74">&#34;comment_count + ?&#34;</span>, <span style="color:#ae81ff">1</span>))
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">// UncheckComment 撤下评论
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">UncheckComment</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Comment</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">comment</span> <span style="color:#a6e22e">Comment</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#a6e22e">Comment</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">article</span> <span style="color:#a6e22e">Article</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">maps</span> = make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{})
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;status&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Status</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">comment</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Updates</span>(<span style="color:#a6e22e">maps</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">res</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">article</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">ArticleId</span>).<span style="color:#a6e22e">UpdateColumn</span>(<span style="color:#e6db74">&#34;comment_count&#34;</span>, <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Expr</span>(<span style="color:#e6db74">&#34;comment_count - ?&#34;</span>, <span style="color:#ae81ff">1</span>))
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}
</code></pre></div><p>2、创建<code>api/v1/comment.go</code>，实现api接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">v1</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/model&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;strconv&#34;</span>
)

<span style="color:#75715e">// AddComment 新增评论
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">AddComment</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">Comment</span>
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">AddComment</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">// GetComment 获取单个评论信息
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetComment</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetComment</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">// DeleteComment 删除评论
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DeleteComment</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">DeleteComment</span>(uint(<span style="color:#a6e22e">id</span>))
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">// GetCommentCount 获取评论数量
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCommentCount</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">total</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetCommentCount</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;total&#34;</span>: <span style="color:#a6e22e">total</span>,
	})
}

<span style="color:#75715e">// GetCommentList 后台查询评论列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCommentList</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">pagesize</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagesize&#34;</span>))
	<span style="color:#a6e22e">pagenum</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagenum&#34;</span>))
	<span style="color:#66d9ef">switch</span> {
	<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">pagesize</span> &gt; <span style="color:#ae81ff">100</span>:
		<span style="color:#a6e22e">pagesize</span> = <span style="color:#ae81ff">100</span>
	<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">pagesize</span> &lt; <span style="color:#ae81ff">0</span>:
		<span style="color:#a6e22e">pagesize</span> = <span style="color:#ae81ff">10</span>
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pagenum</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">pagenum</span> = <span style="color:#ae81ff">1</span>
	}
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">total</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetCommentList</span>(<span style="color:#a6e22e">pagesize</span>, <span style="color:#a6e22e">pagenum</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;total&#34;</span>:   <span style="color:#a6e22e">total</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">// GetCommentListFront 展示页面显示评论列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetCommentListFront</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">pagesize</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagesize&#34;</span>))
	<span style="color:#a6e22e">pagenum</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagenum&#34;</span>))
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>((<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>)))
	<span style="color:#66d9ef">switch</span> {
	<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">pagesize</span> &gt; <span style="color:#ae81ff">100</span>:
		<span style="color:#a6e22e">pagesize</span> = <span style="color:#ae81ff">100</span>
	<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">pagesize</span> &lt; <span style="color:#ae81ff">0</span>:
		<span style="color:#a6e22e">pagesize</span> = <span style="color:#ae81ff">10</span>
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pagenum</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">pagenum</span> = <span style="color:#ae81ff">1</span>
	}
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">total</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetCommentListFront</span>(<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">pagesize</span>, <span style="color:#a6e22e">pagenum</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;total&#34;</span>:   <span style="color:#a6e22e">total</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">// CheckComment 通过审核
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CheckComment</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">Comment</span>
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>((<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>)))
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CheckComment</span>(<span style="color:#a6e22e">id</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">// UncheckComment 撤下评论审核
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">UncheckComment</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">Comment</span>
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>((<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>)))
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">UncheckComment</span>(<span style="color:#a6e22e">id</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

</code></pre></div><p>3、在<code>routers/router.go</code>中添加评论相关的路由</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">router</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	{
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;comment&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">AddComment</span>)	<span style="color:#75715e">//添加评论
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;comment/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetComment</span>)	<span style="color:#75715e">//获取单个评论信息
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;commentsfront/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCommentListFront</span>)	<span style="color:#75715e">//获取某个文章下的所有评论
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;commentcount/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCommentCount</span>)	<span style="color:#75715e">//获取某个文章下评论数量
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;comments&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCommentList</span>)	<span style="color:#75715e">//获取所有评论列表
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#e6db74">&#34;comment/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">DeleteComment</span>)	<span style="color:#75715e">//删除评论
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;checkcomment/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">CheckComment</span>)	<span style="color:#75715e">//审核通过评论
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;uncheckcomment/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">UncheckComment</span>)	<span style="color:#75715e">//撤下评论
</span><span style="color:#75715e"></span>	}
</code></pre></div><h3 id="实现个人简介相关api">实现个人简介相关api</h3>
<blockquote>
<p>个人简介模块需要实现的功能：</p>
<p>获取简介、更新简介</p>
</blockquote>
<p>1、在<code>model/Profile.go</code>中先实现相关查询数据库的操作</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Profile</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">ID</span>        <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;primaryKey&#34; json:&#34;id&#34;`</span>
	<span style="color:#a6e22e">Name</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(20)&#34; json:&#34;name&#34;`</span>
	<span style="color:#a6e22e">Desc</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;desc&#34;`</span>
	<span style="color:#a6e22e">Qqchat</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;qq_chat&#34;`</span>
	<span style="color:#a6e22e">Wechat</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(100)&#34; json:&#34;wechat&#34;`</span>
	<span style="color:#a6e22e">Weibo</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;weibo&#34;`</span>
	<span style="color:#a6e22e">Bili</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;bili&#34;`</span>
	<span style="color:#a6e22e">Email</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;email&#34;`</span>
	<span style="color:#a6e22e">Img</span>       <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;img&#34;`</span>
	<span style="color:#a6e22e">Avatar</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;avatar&#34;`</span>
	<span style="color:#a6e22e">IcpRecord</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(200)&#34; json:&#34;icp_record&#34;`</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetProfile</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) (<span style="color:#a6e22e">Profile</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">profile</span> <span style="color:#a6e22e">Profile</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;ID = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">profile</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">profile</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">profile</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">UpdateProfile</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Profile</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">profile</span> <span style="color:#a6e22e">Profile</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">profile</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;ID = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Updates</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}
</code></pre></div><p>2、创建<code>api/v1/profile.go</code>，实现api接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">v1</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/model&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;strconv&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetProfile</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetProfile</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">UpdateProfile</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">profile</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">Profile</span>
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">profile</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">UpdateProfile</span>(<span style="color:#a6e22e">id</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">profile</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})

}
</code></pre></div><p>3、在<code>routers/router.go</code>中添加个人简介相关的路由</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">router</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	{
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;profile/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetProfile</span>)	<span style="color:#75715e">//获取个人简介
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;profile/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">UpdateProfile</span>)	<span style="color:#75715e">//更新个人简介
</span><span style="color:#75715e"></span>	}
</code></pre></div><h3 id="实现上传相关api">实现上传相关api</h3>
<blockquote>
<p>上传模块需要实现的功能：</p>
<p>上传文件到七牛云存储空间</p>
</blockquote>
<p>1、在<code>config/config.ini</code>中添加关于七牛云的配置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ini" data-lang="ini"><span style="color:#66d9ef">[qiniu]</span>
<span style="color:#a6e22e">AccessKey</span><span style="color:#f92672">=</span> <span style="color:#e6db74">七牛云的AK</span>
<span style="color:#a6e22e">SecretKey</span><span style="color:#f92672">=</span> <span style="color:#e6db74">七牛云的SK</span>
<span style="color:#a6e22e">Bucket</span><span style="color:#f92672">=</span> <span style="color:#e6db74">七牛云的存储空间</span>
<span style="color:#a6e22e">QiniuSever</span> <span style="color:#f92672">=</span>  <span style="color:#e6db74">七牛云的空间的域名</span>
</code></pre></div><p>2、修改<code>utils/setting.go</code>读取七牛云配置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">utils</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;gopkg.in/ini.v1&#34;</span>
)

<span style="color:#66d9ef">var</span> (
	<span style="color:#a6e22e">AppMode</span>    <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">HttpPort</span>   <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">JwtKey</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DB</span>         <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbHost</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbPort</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbUser</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbPassWord</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">DbName</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">AccessKey</span>  <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">SecretKey</span>  <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">Bucket</span>     <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">QiniuSever</span> <span style="color:#66d9ef">string</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">init</span>() {
	<span style="color:#a6e22e">cfg</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ini</span>.<span style="color:#a6e22e">Load</span>(<span style="color:#e6db74">&#34;config/config.ini&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;读取配置文件出错，请检查文件路径：&#34;</span>, <span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span>
	}
	<span style="color:#a6e22e">LoadServer</span>(<span style="color:#a6e22e">cfg</span>)
	<span style="color:#a6e22e">LoadDatabase</span>(<span style="color:#a6e22e">cfg</span>)
	<span style="color:#a6e22e">LoadQiniu</span>(<span style="color:#a6e22e">cfg</span>)

}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoadServer</span>(<span style="color:#a6e22e">file</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ini</span>.<span style="color:#a6e22e">File</span>) {
	<span style="color:#a6e22e">AppMode</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;server&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;AppMode&#34;</span>).<span style="color:#a6e22e">MustString</span>(<span style="color:#e6db74">&#34;debug&#34;</span>)
	<span style="color:#a6e22e">HttpPort</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;server&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;HttpPort&#34;</span>).<span style="color:#a6e22e">MustString</span>(<span style="color:#e6db74">&#34;:3000&#34;</span>)
	<span style="color:#a6e22e">JwtKey</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;server&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;JwtKey&#34;</span>).<span style="color:#a6e22e">MustString</span>(<span style="color:#e6db74">&#34;abcd3efg&#34;</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoadDatabase</span>(<span style="color:#a6e22e">file</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ini</span>.<span style="color:#a6e22e">File</span>) {
	<span style="color:#a6e22e">DB</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DB&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbHost</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbHost&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbPort</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbPort&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbUser</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbUser&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbPassWord</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbPassWord&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">DbName</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;database&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;DbName&#34;</span>).<span style="color:#a6e22e">String</span>()
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoadQiniu</span>(<span style="color:#a6e22e">file</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ini</span>.<span style="color:#a6e22e">File</span>) {
	<span style="color:#a6e22e">AccessKey</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;qiniu&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;AccessKey&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">SecretKey</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;qiniu&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;SecretKey&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">Bucket</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;qiniu&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;Bucket&#34;</span>).<span style="color:#a6e22e">String</span>()
	<span style="color:#a6e22e">QiniuSever</span> = <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Section</span>(<span style="color:#e6db74">&#34;qiniu&#34;</span>).<span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;QiniuSever&#34;</span>).<span style="color:#a6e22e">String</span>()
}
</code></pre></div><p>3、在<code>model/Upload.go</code>中先实现相关查询数据库的操作</p>
<p>七牛云相关的sdk文档参考：</p>
<blockquote>
<p><a href="https://developer.qiniu.com/kodo/1238/go">https://developer.qiniu.com/kodo/1238/go</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;context&#34;</span>
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/qiniu/go-sdk/v7/auth/qbox&#34;</span>
	<span style="color:#e6db74">&#34;github.com/qiniu/go-sdk/v7/storage&#34;</span>
	<span style="color:#e6db74">&#34;mime/multipart&#34;</span>
)

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">AccessKey</span> = <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">AccessKey</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">SecretKey</span> = <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">SecretKey</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">Bucket</span> = <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">Bucket</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ImgUrl</span> = <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">QiniuSever</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">UpLoadFile</span>(<span style="color:#a6e22e">file</span> <span style="color:#a6e22e">multipart</span>.<span style="color:#a6e22e">File</span>, <span style="color:#a6e22e">fileSize</span> <span style="color:#66d9ef">int64</span>) (<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#a6e22e">putPolicy</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">PutPolicy</span>{
		<span style="color:#a6e22e">Scope</span>: <span style="color:#a6e22e">Bucket</span>,
	}
	<span style="color:#a6e22e">mac</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">qbox</span>.<span style="color:#a6e22e">NewMac</span>(<span style="color:#a6e22e">AccessKey</span>, <span style="color:#a6e22e">SecretKey</span>)
	<span style="color:#a6e22e">upToken</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">putPolicy</span>.<span style="color:#a6e22e">UploadToken</span>(<span style="color:#a6e22e">mac</span>)
	<span style="color:#a6e22e">cfg</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">Config</span>{
		<span style="color:#a6e22e">Zone</span>:          <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">ZoneHuanan</span>,
		<span style="color:#a6e22e">UseCdnDomains</span>: <span style="color:#66d9ef">false</span>,
		<span style="color:#a6e22e">UseHTTPS</span>:      <span style="color:#66d9ef">false</span>,
	}
	<span style="color:#a6e22e">putExtra</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">PutExtra</span>{}
	<span style="color:#a6e22e">formUploader</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">NewFormUploader</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cfg</span>)
	<span style="color:#a6e22e">ret</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">PutRet</span>{}

	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">formUploader</span>.<span style="color:#a6e22e">PutWithoutKey</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ret</span>, <span style="color:#a6e22e">upToken</span>, <span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">fileSize</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">putExtra</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#a6e22e">url</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ImgUrl</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ret</span>.<span style="color:#a6e22e">Key</span>
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">url</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}
</code></pre></div><p>4、创建<code>api/v1/upload.go</code>，实现api接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">v1</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/model&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">UpLoad</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">fileHeader</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">FormFile</span>(<span style="color:#e6db74">&#34;file&#34;</span>)
	<span style="color:#a6e22e">fileSize</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fileHeader</span>.<span style="color:#a6e22e">Size</span>
	<span style="color:#a6e22e">url</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">UpLoadFile</span>(<span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">fileSize</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
		<span style="color:#e6db74">&#34;url&#34;</span>:     <span style="color:#a6e22e">url</span>,
	})
}
</code></pre></div><p>5、在<code>routers/router.go</code>中添加上传相关的路由</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">router</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	{
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;upload&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">UpLoad</span>) <span style="color:#75715e">//上传七牛云
</span><span style="color:#75715e"></span>	}
</code></pre></div><h3 id="实现用户相关api">实现用户相关api</h3>
<blockquote>
<p>用户模块需要实现的功能：</p>
<p>查询用户是否存在、添加用户、查询单个用户、查询用户列表、编辑用户、删除用户、登录</p>
</blockquote>
<p>1、在<code>model/user.go</code>中先实现相关查询数据库的操作</p>
<p>用户的密码需要加密后再保存，这边用到了scrypt这个库；同时用到了gorm的BeforeSave这个钩子函数，在每次保存密码之前就会调用加密用户密码的功能。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">model</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;encoding/base64&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;golang.org/x/crypto/scrypt&#34;</span>
	<span style="color:#e6db74">&#34;gorm.io/gorm&#34;</span>
	<span style="color:#e6db74">&#34;log&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
	<span style="color:#a6e22e">Username</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(20);not null&#34; json:&#34;username&#34; validate:&#34;required,min=4,max=12&#34; label:&#34;用户名&#34;`</span>
	<span style="color:#a6e22e">Password</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;type:varchar(20);not null&#34; json:&#34;password&#34; validate:&#34;required,min=6,max=20&#34; label:&#34;密码&#34;`</span>
	<span style="color:#a6e22e">Role</span>     <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;type:int;DEFAULT 2&#34; json:&#34;role&#34; validate:&#34;required,gte=2&#34; label:&#34;角色码&#34;`</span>
}

<span style="color:#75715e">//查询用户是否存在
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CheckUser</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Select</span>(<span style="color:#e6db74">&#34;id&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;username = ?&#34;</span>, <span style="color:#a6e22e">name</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">ID</span> &gt; <span style="color:#ae81ff">0</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_USERNAME_USED</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//更新查询
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CheckUpUser</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Select</span>(<span style="color:#e6db74">&#34;id,username&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;username = ?&#34;</span>, <span style="color:#a6e22e">name</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">ID</span> <span style="color:#f92672">==</span> uint(<span style="color:#a6e22e">id</span>) {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">ID</span> &gt; <span style="color:#ae81ff">0</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_USERNAME_USED</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//添加用户
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CreateUser</span>(<span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">User</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#75715e">//data.Password = ScrpytPw(data.Password)
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//查询单个用户
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetUser</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) (<span style="color:#a6e22e">User</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;ID = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//查询用户列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetUsers</span>(<span style="color:#a6e22e">username</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">pageNum</span> <span style="color:#66d9ef">int</span>) ([]<span style="color:#a6e22e">User</span>, <span style="color:#66d9ef">int64</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">users</span> []<span style="color:#a6e22e">User</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">total</span> <span style="color:#66d9ef">int64</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">username</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
		<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Limit</span>(<span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Offset</span>((<span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">users</span>).<span style="color:#a6e22e">Error</span>
		<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">users</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">ErrRecordNotFound</span> {
			<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#ae81ff">0</span>
		}
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">users</span>, <span style="color:#a6e22e">total</span>
	}
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;username LIKE ?&#34;</span>, <span style="color:#a6e22e">username</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;%&#34;</span>).<span style="color:#a6e22e">Limit</span>(<span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Offset</span>((<span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">pageSize</span>).<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">users</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">users</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;username LIKE ?&#34;</span>, <span style="color:#a6e22e">username</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;%&#34;</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">total</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">ErrRecordNotFound</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#ae81ff">0</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">users</span>, <span style="color:#a6e22e">total</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">user</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">User</span>) <span style="color:#a6e22e">BeforeSave</span>(<span style="color:#a6e22e">tx</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DB</span>) <span style="color:#66d9ef">error</span> {
	<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">Password</span> = <span style="color:#a6e22e">ScrpytPw</span>(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">Password</span>)
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
}

<span style="color:#75715e">//编辑用户
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">EditUser</span>(<span style="color:#a6e22e">userid</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">User</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">maps</span> = make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{})
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;username&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Username</span>
	<span style="color:#a6e22e">maps</span>[<span style="color:#e6db74">&#34;role&#34;</span>] = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Role</span>
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{}).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">userid</span>).<span style="color:#a6e22e">Updates</span>(<span style="color:#a6e22e">maps</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//删除用户
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DeleteUser</span>(<span style="color:#a6e22e">userid</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">userid</span>).<span style="color:#a6e22e">Delete</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{}).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//密码加密
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">ScrpytPw</span>(<span style="color:#a6e22e">password</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">KeyLen</span> = <span style="color:#ae81ff">10</span>
	<span style="color:#a6e22e">salt</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">byte</span>, <span style="color:#ae81ff">8</span>)
	<span style="color:#a6e22e">salt</span> = []<span style="color:#66d9ef">byte</span>{<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">1</span>}
	<span style="color:#a6e22e">hashPw</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">scrypt</span>.<span style="color:#a6e22e">Key</span>([]byte(<span style="color:#a6e22e">password</span>), <span style="color:#a6e22e">salt</span>, <span style="color:#ae81ff">16384</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">KeyLen</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">fpw</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">base64</span>.<span style="color:#a6e22e">StdEncoding</span>.<span style="color:#a6e22e">EncodeToString</span>(<span style="color:#a6e22e">hashPw</span>)
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fpw</span>
}

<span style="color:#75715e">// ChangePassword 修改密码
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">ChangePassword</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">data</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">User</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Select</span>(<span style="color:#e6db74">&#34;password&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;id = ?&#34;</span>, <span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">Updates</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>).<span style="color:#a6e22e">Error</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//登录验证
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CheckLogin</span>(<span style="color:#a6e22e">username</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">password</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">User</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;username = ?&#34;</span>, <span style="color:#a6e22e">username</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">ID</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_USER_NOT_EXIST</span>
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">ScrpytPw</span>(<span style="color:#a6e22e">password</span>) <span style="color:#f92672">!=</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">Password</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_PASSWORD_WRONG</span>
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">Role</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_USER_NO_RIGHT</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}

<span style="color:#75715e">//前台登录
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CheckLoginFront</span>(<span style="color:#a6e22e">username</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">password</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">User</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;username = ?&#34;</span>, <span style="color:#a6e22e">username</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">ID</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_USER_NOT_EXIST</span>
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">ScrpytPw</span>(<span style="color:#a6e22e">password</span>) <span style="color:#f92672">!=</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">Password</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_PASSWORD_WRONG</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}
</code></pre></div><p>2、创建<code>utils/validator/validator.go</code>，实现验证功能；先要先go get相关库</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">validator</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/go-playground/locales/zh_Hans_CN&#34;</span>
	<span style="color:#a6e22e">unTrans</span> <span style="color:#e6db74">&#34;github.com/go-playground/universal-translator&#34;</span>
	<span style="color:#e6db74">&#34;github.com/go-playground/validator/v10&#34;</span>
	<span style="color:#a6e22e">zhTrans</span> <span style="color:#e6db74">&#34;github.com/go-playground/validator/v10/translations/zh&#34;</span>
	<span style="color:#e6db74">&#34;reflect&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Validate</span>(<span style="color:#a6e22e">data</span> <span style="color:#66d9ef">interface</span>{}) (<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#a6e22e">validate</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">New</span>()
	<span style="color:#a6e22e">uni</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">unTrans</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">zh_Hans_CN</span>.<span style="color:#a6e22e">New</span>())
	<span style="color:#a6e22e">trans</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">uni</span>.<span style="color:#a6e22e">GetTranslator</span>(<span style="color:#e6db74">&#34;zh_Hans_CN&#34;</span>)
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">zhTrans</span>.<span style="color:#a6e22e">RegisterDefaultTranslations</span>(<span style="color:#a6e22e">validate</span>, <span style="color:#a6e22e">trans</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;err:&#34;</span>, <span style="color:#a6e22e">err</span>)
	}

	<span style="color:#a6e22e">validate</span>.<span style="color:#a6e22e">RegisterTagNameFunc</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">field</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">StructField</span>) <span style="color:#66d9ef">string</span> {
		<span style="color:#a6e22e">label</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">field</span>.<span style="color:#a6e22e">Tag</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;label&#34;</span>)
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">label</span>
	})
	<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">validate</span>.<span style="color:#a6e22e">Struct</span>(<span style="color:#a6e22e">data</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">err</span>.(<span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">ValidationErrors</span>) {
			<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">Translate</span>(<span style="color:#a6e22e">trans</span>), <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
		}
	}
	<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
}
</code></pre></div><p>3、创建<code>api/v1/user.go</code>，实现api接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">v1</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/model&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/validator&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;strconv&#34;</span>
)

<span style="color:#75715e">//添加用户
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">AddUser</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">User</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msg</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">msg</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">Validate</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span> {
		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
			<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
			<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">msg</span>,
		})
		<span style="color:#66d9ef">return</span>
	}
	<span style="color:#a6e22e">code</span> = <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CheckUser</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Username</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span> {
		<span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CreateUser</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	}
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">//查询单个用户
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetUserInfo</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetUser</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
		<span style="color:#e6db74">&#34;total&#34;</span>:   <span style="color:#ae81ff">1</span>,
	})
}

<span style="color:#75715e">//查询用户列表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetUsers</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagesize&#34;</span>))
	<span style="color:#a6e22e">pageNum</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;pagenum&#34;</span>))
	<span style="color:#a6e22e">username</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;username&#34;</span>)

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pageNum</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">pageNum</span> = <span style="color:#ae81ff">1</span>
	}
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">total</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">GetUsers</span>(<span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">pageSize</span>, <span style="color:#a6e22e">pageNum</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
		<span style="color:#e6db74">&#34;total&#34;</span>:   <span style="color:#a6e22e">total</span>,
	})
}

<span style="color:#75715e">//编辑用户
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">EditUser</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CheckUpUser</span>(<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Username</span>)

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span> {
		<span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">EditUser</span>(<span style="color:#a6e22e">id</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_USERNAME_USED</span> {
		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Abort</span>()
	}
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">//删除用户
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DeleteUser</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">DeleteUser</span>(<span style="color:#a6e22e">id</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}

<span style="color:#75715e">// ChangeUserPassword 修改密码
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">ChangeUserPassword</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>))
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">ChangePassword</span>(<span style="color:#a6e22e">id</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}
</code></pre></div><p>4、在<code>routers/router.go</code>中添加用户相关的路由</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">router</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	{
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;user/add&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">AddUser</span>) <span style="color:#75715e">//添加用户
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;users&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetUsers</span>)	<span style="color:#75715e">//获取所有用户列表
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;user/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetUserInfo</span>)	<span style="color:#75715e">//获取单个用户信息
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;user/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">EditUser</span>)		<span style="color:#75715e">//编辑用户
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#e6db74">&#34;user/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">DeleteUser</span>)	<span style="color:#75715e">//删除用户
</span><span style="color:#75715e"></span>	}
</code></pre></div><h3 id="实现登录相关api">实现登录相关api</h3>
<blockquote>
<p>登录模块需要实现的功能：</p>
<p>后台登录、前台登录</p>
</blockquote>
<p>1、创建<code>api/v1/login.go</code>，实现api接口</p>
<p>这边有用到中间件，在下一个章节有讲到</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">v1</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/middleware&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/model&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Login</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">token</span> <span style="color:#66d9ef">string</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">code</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span> = <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CheckLogin</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Username</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Password</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span> {
		<span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">middleware</span>.<span style="color:#a6e22e">SetToken</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Username</span>)

	}
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
		<span style="color:#e6db74">&#34;token&#34;</span>:   <span style="color:#a6e22e">token</span>,
	})
}

<span style="color:#75715e">// LoginFront 前台登录
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoginFront</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">User</span>
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">data</span>)
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">code</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">code</span> = <span style="color:#a6e22e">model</span>.<span style="color:#a6e22e">CheckLoginFront</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Username</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Password</span>)

	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
		<span style="color:#e6db74">&#34;status&#34;</span>:  <span style="color:#a6e22e">code</span>,
		<span style="color:#e6db74">&#34;data&#34;</span>:    <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Username</span>,
		<span style="color:#e6db74">&#34;id&#34;</span>:      <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">ID</span>,
		<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
	})
}
</code></pre></div><p>2、在<code>routers/router.go</code>中添加上传相关的路由</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">router</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	{
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;login&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">Login</span>)		<span style="color:#75715e">//后台登录
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;loginfront&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">LoginFront</span>)	<span style="color:#75715e">//前台登录
</span><span style="color:#75715e"></span>	}
</code></pre></div><h2 id="中间件">中间件</h2>
<p>1、使用jwt实现登录控制；添加<code>middleware/jwt.go</code>文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">middleware</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;ginblog/utils&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils/errmsg&#34;</span>
	<span style="color:#e6db74">&#34;github.com/dgrijalva/jwt-go&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;strings&#34;</span>
	<span style="color:#e6db74">&#34;time&#34;</span>
)

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">JwtKey</span> = []byte(<span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">JwtKey</span>)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">MyClaims</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Username</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;username&#34;`</span>
	<span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">StandardClaims</span>
}

<span style="color:#75715e">//生成token
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">SetToken</span>(<span style="color:#a6e22e">username</span> <span style="color:#66d9ef">string</span>) (<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#a6e22e">expireTime</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>().<span style="color:#a6e22e">Add</span>(<span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Hour</span>)
	<span style="color:#a6e22e">SetClaims</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">MyClaims</span>{
		<span style="color:#a6e22e">username</span>,
		<span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">StandardClaims</span>{
			<span style="color:#a6e22e">ExpiresAt</span>: <span style="color:#a6e22e">expireTime</span>.<span style="color:#a6e22e">Unix</span>(),
			<span style="color:#a6e22e">Issuer</span>:    <span style="color:#e6db74">&#34;ginblog&#34;</span>,
		},
	}
	<span style="color:#a6e22e">reqClaim</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">NewWithClaims</span>(<span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">SigningMethodHS256</span>, <span style="color:#a6e22e">SetClaims</span>)
	<span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reqClaim</span>.<span style="color:#a6e22e">SignedString</span>(<span style="color:#a6e22e">JwtKey</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>

}

<span style="color:#75715e">//验证token
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Checktoken</span>(<span style="color:#a6e22e">token</span> <span style="color:#66d9ef">string</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">MyClaims</span>, <span style="color:#66d9ef">int</span>) {
	<span style="color:#a6e22e">setToken</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">ParseWithClaims</span>(<span style="color:#a6e22e">token</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">MyClaims</span>{}, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">token</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">Token</span>) (<span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JwtKey</span>, <span style="color:#66d9ef">nil</span>
	})
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">setToken</span>.<span style="color:#a6e22e">Claims</span>.(<span style="color:#f92672">*</span><span style="color:#a6e22e">MyClaims</span>); <span style="color:#a6e22e">setToken</span>.<span style="color:#a6e22e">Valid</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">SUCCSE</span>
	} <span style="color:#66d9ef">else</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span>
	}
}

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">code</span> <span style="color:#66d9ef">int</span>

<span style="color:#75715e">//jwt中间件
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">JwtToken</span>() <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">HandlerFunc</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
		<span style="color:#a6e22e">tokenHeader</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;Authorization&#34;</span>)

		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">tokenHeader</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
			<span style="color:#a6e22e">code</span> = <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_TOKEN_EXIST</span>
		}
		<span style="color:#a6e22e">checkToken</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">SplitN</span>(<span style="color:#a6e22e">tokenHeader</span>, <span style="color:#e6db74">&#34; &#34;</span>, <span style="color:#ae81ff">2</span>)
		<span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">checkToken</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">checkToken</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;Bearer&#34;</span> {
			<span style="color:#a6e22e">code</span> = <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_TOKEN_TYPE_WRONG</span>
			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
				<span style="color:#e6db74">&#34;code&#34;</span>:    <span style="color:#a6e22e">code</span>,
				<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
			})
			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Abort</span>()
			<span style="color:#66d9ef">return</span>
		}
		<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">tCode</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Checktoken</span>(<span style="color:#a6e22e">checkToken</span>[<span style="color:#ae81ff">1</span>])
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">tCode</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR</span> {
			<span style="color:#a6e22e">code</span> = <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_TOKEN_WRONG</span>
			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
				<span style="color:#e6db74">&#34;code&#34;</span>:    <span style="color:#a6e22e">code</span>,
				<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
			})
			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Abort</span>()
			<span style="color:#66d9ef">return</span>
		}
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>().<span style="color:#a6e22e">Unix</span>() &gt; <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">ExpiresAt</span> {
			<span style="color:#a6e22e">code</span> = <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">ERROR_TOKEN_RUNTIME</span>
			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
				<span style="color:#e6db74">&#34;code&#34;</span>:    <span style="color:#a6e22e">code</span>,
				<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#a6e22e">errmsg</span>.<span style="color:#a6e22e">GetErrMsg</span>(<span style="color:#a6e22e">code</span>),
			})
			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Abort</span>()
			<span style="color:#66d9ef">return</span>
		}
		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;username&#34;</span>, <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">Username</span>)
		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Next</span>()
	}
}
</code></pre></div><p>2、跨域中间件、添加<code>middleware/cors.go</code>文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">middleware</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;github.com/gin-contrib/cors&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#e6db74">&#34;time&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Cors</span>() <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">HandlerFunc</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cors</span>.<span style="color:#a6e22e">New</span>(
		<span style="color:#a6e22e">cors</span>.<span style="color:#a6e22e">Config</span>{
			<span style="color:#75715e">//AllowAllOrigins:  true,
</span><span style="color:#75715e"></span>			<span style="color:#a6e22e">AllowOrigins</span>:     []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;*&#34;</span>}, <span style="color:#75715e">// 等同于允许所有域名 #AllowAllOrigins:  true
</span><span style="color:#75715e"></span>			<span style="color:#a6e22e">AllowMethods</span>:     []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;POST&#34;</span>, <span style="color:#e6db74">&#34;PUT&#34;</span>, <span style="color:#e6db74">&#34;DELETE&#34;</span>, <span style="color:#e6db74">&#34;OPTIONS&#34;</span>},
			<span style="color:#a6e22e">AllowHeaders</span>:     []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;*&#34;</span>,<span style="color:#e6db74">&#34;Authorization&#34;</span>},
			<span style="color:#a6e22e">ExposeHeaders</span>:    []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;Content-Length&#34;</span>, <span style="color:#e6db74">&#34;text/plain&#34;</span>, <span style="color:#e6db74">&#34;Authorization&#34;</span>, <span style="color:#e6db74">&#34;Content-Type&#34;</span>,<span style="color:#e6db74">&#34;Access-Control-Allow-Origin&#34;</span>, <span style="color:#e6db74">&#34;Access-Control-Allow-Headers&#34;</span>, <span style="color:#e6db74">&#34;Cache-Control&#34;</span>, <span style="color:#e6db74">&#34;Content-Language&#34;</span>},
			<span style="color:#a6e22e">AllowCredentials</span>: <span style="color:#66d9ef">true</span>,
			<span style="color:#a6e22e">MaxAge</span>:           <span style="color:#ae81ff">12</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Hour</span>,
		},
	)
}
</code></pre></div><p>3、日志中间件;</p>
<p>使用<code>logrus</code>来记录日志；<code>file-rotatelog</code>来按天分割日志，<code>lfshook</code>为了<code>logrus</code>定制的本地文件系统钩子</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">middleware</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#a6e22e">retalog</span> <span style="color:#e6db74">&#34;github.com/lestrrat-go/file-rotatelogs&#34;</span>
	<span style="color:#e6db74">&#34;github.com/rifflock/lfshook&#34;</span>
	<span style="color:#e6db74">&#34;github.com/sirupsen/logrus&#34;</span>
	<span style="color:#e6db74">&#34;math&#34;</span>
	<span style="color:#e6db74">&#34;os&#34;</span>
	<span style="color:#e6db74">&#34;time&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Logger</span>() <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">HandlerFunc</span> {
	<span style="color:#a6e22e">filePath</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;log/log&#34;</span>
	<span style="color:#a6e22e">linkName</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;lastest_log.log&#34;</span>
	<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">OpenFile</span>(<span style="color:#a6e22e">filePath</span>, <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_CREATE</span>|<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_WRONLY</span>, <span style="color:#ae81ff">0755</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;err:&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">logger</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">New</span>()
	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Out</span> = <span style="color:#a6e22e">src</span>
	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">SetLevel</span>(<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">DebugLevel</span>)

	<span style="color:#a6e22e">logWriter</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">retalog</span>.<span style="color:#a6e22e">New</span>(
		<span style="color:#a6e22e">filePath</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;%Y%m%d.log&#34;</span>,
		<span style="color:#a6e22e">retalog</span>.<span style="color:#a6e22e">WithMaxAge</span>(<span style="color:#ae81ff">7</span><span style="color:#f92672">*</span><span style="color:#ae81ff">24</span><span style="color:#f92672">*</span><span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Hour</span>),
		<span style="color:#a6e22e">retalog</span>.<span style="color:#a6e22e">WithRotationTime</span>(<span style="color:#ae81ff">24</span><span style="color:#f92672">*</span><span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Hour</span>),
		<span style="color:#a6e22e">retalog</span>.<span style="color:#a6e22e">WithLinkName</span>(<span style="color:#a6e22e">linkName</span>),
	)

	<span style="color:#a6e22e">writeMap</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">lfshook</span>.<span style="color:#a6e22e">WriterMap</span>{
		<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">InfoLevel</span>:  <span style="color:#a6e22e">logWriter</span>,
		<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">FatalLevel</span>: <span style="color:#a6e22e">logWriter</span>,
		<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">DebugLevel</span>: <span style="color:#a6e22e">logWriter</span>,
		<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">WarnLevel</span>:  <span style="color:#a6e22e">logWriter</span>,
		<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">ErrorLevel</span>: <span style="color:#a6e22e">logWriter</span>,
		<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">PanicLevel</span>: <span style="color:#a6e22e">logWriter</span>,
		<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">TraceLevel</span>: <span style="color:#a6e22e">logWriter</span>,
	}
	<span style="color:#a6e22e">Hook</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">lfshook</span>.<span style="color:#a6e22e">NewHook</span>(<span style="color:#a6e22e">writeMap</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">TextFormatter</span>{
		<span style="color:#a6e22e">TimestampFormat</span>: <span style="color:#e6db74">&#34;2006-01-02 15:04:05&#34;</span>,
	})
	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">AddHook</span>(<span style="color:#a6e22e">Hook</span>)
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
		<span style="color:#a6e22e">startTime</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Next</span>()
		<span style="color:#a6e22e">stopTime</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">startTime</span>)
		<span style="color:#a6e22e">spendTime</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>, int(<span style="color:#a6e22e">math</span>.<span style="color:#a6e22e">Ceil</span>(float64(<span style="color:#a6e22e">stopTime</span>.<span style="color:#a6e22e">Nanoseconds</span>())<span style="color:#f92672">/</span><span style="color:#ae81ff">1000000.0</span>)))
		<span style="color:#a6e22e">hostName</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Hostname</span>()
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
			<span style="color:#a6e22e">hostName</span> = <span style="color:#e6db74">&#34;unknown&#34;</span>
		}
		<span style="color:#a6e22e">statusCode</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Writer</span>.<span style="color:#a6e22e">Status</span>()
		<span style="color:#a6e22e">clientIp</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ClientIP</span>()
		<span style="color:#a6e22e">userAgent</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">UserAgent</span>()
		<span style="color:#a6e22e">dataSize</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Writer</span>.<span style="color:#a6e22e">Size</span>()
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">dataSize</span> &lt; <span style="color:#ae81ff">0</span> {
			<span style="color:#a6e22e">dataSize</span> = <span style="color:#ae81ff">0</span>
		}
		<span style="color:#a6e22e">method</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">Method</span>
		<span style="color:#a6e22e">path</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">RequestURI</span>
		<span style="color:#a6e22e">entry</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">WithFields</span>(<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">Fields</span>{
			<span style="color:#e6db74">&#34;HostName&#34;</span>:  <span style="color:#a6e22e">hostName</span>,
			<span style="color:#e6db74">&#34;status&#34;</span>:    <span style="color:#a6e22e">statusCode</span>,
			<span style="color:#e6db74">&#34;SpendTime&#34;</span>: <span style="color:#a6e22e">spendTime</span>,
			<span style="color:#e6db74">&#34;Ip&#34;</span>:        <span style="color:#a6e22e">clientIp</span>,
			<span style="color:#e6db74">&#34;Method&#34;</span>:    <span style="color:#a6e22e">method</span>,
			<span style="color:#e6db74">&#34;Path&#34;</span>:      <span style="color:#a6e22e">path</span>,
			<span style="color:#e6db74">&#34;DataSize&#34;</span>:  <span style="color:#a6e22e">dataSize</span>,
			<span style="color:#e6db74">&#34;Agent&#34;</span>:     <span style="color:#a6e22e">userAgent</span>,
		})
		<span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Errors</span>) &gt; <span style="color:#ae81ff">0</span> {
			<span style="color:#a6e22e">entry</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Errors</span>.<span style="color:#a6e22e">ByType</span>(<span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">ErrorTypePrivate</span>).<span style="color:#a6e22e">String</span>())
		}
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">statusCode</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">500</span> {
			<span style="color:#a6e22e">entry</span>.<span style="color:#a6e22e">Error</span>()
		} <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">statusCode</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">400</span> {
			<span style="color:#a6e22e">entry</span>.<span style="color:#a6e22e">Warn</span>()
		} <span style="color:#66d9ef">else</span> {
			<span style="color:#a6e22e">entry</span>.<span style="color:#a6e22e">Info</span>()
		}
	}
}
</code></pre></div><p>4、实现完中间件后，修改<code>routers/router.go</code>，将中间件应用上去</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">routers</span>

<span style="color:#f92672">import</span> (
	<span style="color:#a6e22e">v1</span> <span style="color:#e6db74">&#34;ginblog/api/v1&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/middleware&#34;</span>
	<span style="color:#e6db74">&#34;ginblog/utils&#34;</span>
	<span style="color:#e6db74">&#34;github.com/gin-gonic/gin&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">InitRouter</span>() {
	<span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">SetMode</span>(<span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">AppMode</span>)
	<span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">New</span>()
	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">HTMLRender</span> = <span style="color:#a6e22e">createMyRender</span>()
	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">middleware</span>.<span style="color:#a6e22e">Logger</span>())
	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Recovery</span>())
	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">middleware</span>.<span style="color:#a6e22e">Cors</span>())
	<span style="color:#a6e22e">routerAdmin</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">middleware</span>.<span style="color:#a6e22e">JwtToken</span>())
	{
		<span style="color:#75715e">//用户模块
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;user/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">EditUser</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#e6db74">&#34;user/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">DeleteUser</span>)
		<span style="color:#75715e">//分类模块
</span><span style="color:#75715e"></span>
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;category/add&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">AddCategory</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;category/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">EditCategory</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#e6db74">&#34;category/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">DeleteCategory</span>)
		<span style="color:#75715e">//文章模块
</span><span style="color:#75715e"></span>
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;article/add&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">AddArticle</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;article/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">EditArticle</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#e6db74">&#34;article/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">DeleteArticle</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;upload&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">UpLoad</span>)
		<span style="color:#75715e">//个人设置
</span><span style="color:#75715e"></span>
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;profile/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">UpdateProfile</span>)
		<span style="color:#75715e">//评论模块
</span><span style="color:#75715e"></span>		<span style="color:#75715e">// 评论模块
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;comments&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCommentList</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#e6db74">&#34;comment/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">DeleteComment</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;checkcomment/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">CheckComment</span>)
		<span style="color:#a6e22e">routerAdmin</span>.<span style="color:#a6e22e">PUT</span>(<span style="color:#e6db74">&#34;uncheckcomment/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">UncheckComment</span>)
	}
	<span style="color:#a6e22e">router</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;api/v1&#34;</span>)
	{
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;user/add&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">AddUser</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;users&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetUsers</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;user/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetUserInfo</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;categorys&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCategorys</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;category/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCateInfo</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;articles&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetArticles</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;article/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetArtInfo</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;article/catelist/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCateArt</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;login&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">Login</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;loginfront&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">LoginFront</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;profile/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetProfile</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;comment&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">AddComment</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;comment/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetComment</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;commentsfront/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCommentListFront</span>)
		<span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;commentcount/:id&#34;</span>, <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GetCommentCount</span>)
	}

	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">HttpPort</span>)
}
</code></pre></div><p>到此后端部分就结束了，运行<code>go run main.go</code>就可以启动程序了</p>
<h2 id="编译成linux上的可执行文件">编译成linux上的可执行文件</h2>
<p>生成ginblog可执行文件。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">set CGO_ENABLED<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
set GOOS<span style="color:#f92672">=</span>linux
set GOARCH<span style="color:#f92672">=</span>amd64
go build -o ginblog  -ldflags <span style="color:#e6db74">&#34;-s -w&#34;</span>
</code></pre></div><h2 id="数据库初始化">数据库初始化</h2>
<p>在项目启动之后，数据库表结构已经创建后之后；需要初始化两条数据：</p>
<pre tabindex="0"><code class="language-mys" data-lang="mys">INSERT INTO `profile` VALUES (1, '个人名称', '请输入个人介绍', 'QQ号码', '微信号码', '微博地址', 'B站地址', '电子邮箱', '头像背景地址', '头像','icp备案');
INSERT INTO `user` VALUES (1, '2022-7-30 17:05:14.764', '2022-7-30 17:05:14.764', NULL, 'admin', 'gDwXPtIYrNmhEA==', 1);
</code></pre>
        </div>

        


        

<div class="post-archive">
    <h2>相关文章</h2>
    <ul class="listing">
        
        <li><a href="/post/Gin%E6%A1%86%E6%9E%B6%E6%A1%88%E4%BE%8B/">Gin框架案例</a></li>
        
        <li><a href="/post/Golang%E6%A1%88%E4%BE%8B-zinx%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">Golang案例 Zinx轻量级服务器框架学习笔记</a></li>
        
        <li><a href="/post/Golang%E5%B0%8F%E6%A1%88%E4%BE%8B-%E7%88%AC%E5%8F%96%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1/">Golang小案例 爬取豆瓣电影</a></li>
        
        <li><a href="/post/Golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E9%80%89%E9%A1%B9%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">Golang设计模式 选项设计模式</a></li>
        
        <li><a href="/post/Gin%E6%A1%86%E6%9E%B6%E7%AC%94%E8%AE%B0/">Gin框架笔记</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/Golang%E6%A1%88%E4%BE%8B' target="_blank">Golang案例</a></li>
                
                <li><a href='/tags/gin' target="_blank">gin</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
    
    

</div>

                    <footer id="footer">
    <div class="container">
        &copy; 2023 <a href="https://kevinbin123.github.io/">abin の 成长之路 By abin</a>.本站博客未经授权禁止转载.
		<br>
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        <a href="http://www.flysnow.org/" target="_blank">Theme</a> based on <a href="https://github.com/rujews/maupassant-hugo" target="_blank">maupassant</a>
		       
    </div>
</footer>


    
    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>
<style type="text/css">
div.highlight {
    position: relative;
    margin: 1em 0px;
}

.copy-code {
    display: none;
    position: absolute;
    top: 4px;
    right: 4px;
    color: rgba(255, 255, 255, 0.8);
    background: rgba(78, 78, 78, 0.8);
    border-radius: var(--radius);
    padding: 0 5px;
    font: inherit;
    user-select: none;
    cursor: pointer;
    border: 0;
    --radius: 8px;
}

div.highlight:hover .copy-code,pre:hover .copy-code {
    display: block;
}

</style>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>


    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




    <script src='/js/bootstrap.min.js'></script>

    <script src='/js/post_category.1.js'></script>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://kevinbin123.github.io/search' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://kevinbin123.github.io/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>

    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://kevinbin123.github.io/post/Koa2&#43;MongoDB%E7%AE%80%E4%B9%A6%E5%90%8E%E5%8F%B0%E7%9A%84%E5%90%8E%E7%AB%AF/" title="Koa2&#43;MongoDB简书后台的后端" target="_blank">Koa2&#43;MongoDB简书后台的后端</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/vue2&#43;ElementUI%E7%AE%80%E4%B9%A6%E5%90%8E%E5%8F%B0%E5%89%8D%E7%AB%AF/" title="Vue2&#43;ElementUI简书后台前端" target="_blank">Vue2&#43;ElementUI简书后台前端</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/js/" title="Js" target="_blank">Js</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/http/" title="go Http标准库的使用" target="_blank">go Http标准库的使用</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/%E7%AE%80%E5%8D%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/" title="简单分布式系统" target="_blank">简单分布式系统</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/fyne%E6%A1%88%E4%BE%8B%E4%B9%8B%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8/" title="Fyne案例之音乐播放器" target="_blank">Fyne案例之音乐播放器</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/fyne%E6%A1%88%E4%BE%8B%E4%B9%8B%E6%8E%A5%E4%BD%8F%E4%BD%A0%E5%B0%8F%E6%B8%B8%E6%88%8F/" title="Fyne案例之接住你小游戏" target="_blank">Fyne案例之接住你小游戏</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/gin&#43;vue2%E5%8D%9A%E5%AE%A2%E7%AC%94%E8%AE%B0%E5%89%8D%E7%AB%AF/" title="Gin&#43;vue2博客笔记（前端）" target="_blank">Gin&#43;vue2博客笔记（前端）</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/gin&#43;vue2%E5%8D%9A%E5%AE%A2%E7%AC%94%E8%AE%B0%E5%90%8E%E7%AB%AF/" title="Gin&#43;vue2博客笔记（后端）" target="_blank">Gin&#43;vue2博客笔记（后端）</a>
    </li>
    
    <li>
        <a href="https://kevinbin123.github.io/post/PWA%E7%AC%94%E8%AE%B0/" title="PWA笔记" target="_blank">PWA笔记</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://kevinbin123.github.io/categories/DB/">DB (2)</a></li>
    
    <li><a href="https://kevinbin123.github.io/categories/Golang/">Golang (20)</a></li>
    
    <li><a href="https://kevinbin123.github.io/categories/JavaScript/">JavaScript (4)</a></li>
    
    <li><a href="https://kevinbin123.github.io/categories/Network/">Network (1)</a></li>
    
    <li><a href="https://kevinbin123.github.io/categories/container/">container (1)</a></li>
    
    <li><a href="https://kevinbin123.github.io/categories/other/">other (5)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
    
    <a href="https://kevinbin123.github.io/tags/DB/">DB</a>
    
    <a href="https://kevinbin123.github.io/tags/Fyne/">Fyne</a>
    
    <a href="https://kevinbin123.github.io/tags/Golang/">Golang</a>
    
    <a href="https://kevinbin123.github.io/tags/Golang%E6%A1%88%E4%BE%8B/">Golang案例</a>
    
    <a href="https://kevinbin123.github.io/tags/JavaScript/">JavaScript</a>
    
    <a href="https://kevinbin123.github.io/tags/Koa2/">Koa2</a>
    
    <a href="https://kevinbin123.github.io/tags/MongoDB/">MongoDB</a>
    
    <a href="https://kevinbin123.github.io/tags/Network/">Network</a>
    
    <a href="https://kevinbin123.github.io/tags/container/">container</a>
    
    <a href="https://kevinbin123.github.io/tags/gin/">gin</a>
    
    <a href="https://kevinbin123.github.io/tags/other/">other</a>
    
    <a href="https://kevinbin123.github.io/tags/vue2/">vue2</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://www.liwenzhou.com/" title="go语言学习之路">李文周的博客</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://kevinbin123.github.io/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>